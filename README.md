# DENTASHOP

## Project Setup

```sh
npm install
```

```sh
npm install --global yarn
```

```sh
yarn install
```

### Start Development version

```sh
npm run dev
```

### DATABASE


Запускаем миграции, которые создадут нужные нам таблицы в базе данных.
```sh
npx sequelize-cli db:migrate
```

Запускаем сидер, который перенесет товары из проекта в БД
```sh
npx sequelize-cli db:seed:all
```

Запускаем сервер с базой данных
```sh
node db.js
```

# Описание проекта

## структура проекта

1. Каталог товаров
2. Страница просмотра товаров
3. Корзина
4. Страница оформления заказа

## Используемые технологии

1. Vue.js 3 - фреймворк для написания фронтенд приложений.
2. axios - HTTP-клиент для Node.js. В проекте используется для записи данных в базу данных.
3. sqlite - Node.js библиотека для работы с SQLite базами данных.
4. TypeScript - язык программирования на котором был написан проект. TypeScript расширяет возможности JavaScript.
5. pinia - расширение для Vue.js. Используется для сохранения информации в localStorage браузера. В проекте используется для хранения информации о товарах + для сохранения корзины.
6. vue-router - Расширение для Vue.js. Используется в создании Single Page Application(SPA). SPA - это приложения с обновлением информации без перезагрузки страницы.
7. sequelize - Node.js ORM. ПРО ORM ПОИЩИ ИНФОРМАЦИЮ В ИНТЕРНЕТЕ! ДА И ПРО МОДЕЛЬКИ, МИГРАЦИИ И СИДЕРЫ ЛУЧШЕ ИНФУ ВЗЯТЬ ТАМ. ГЛАВНОЕ ПРИ ПОИСКЕ УКАЗЫВАЙ, ЧТО ИЩЕЩЬ МИГРАЦИИ ИМЕННО В ORM! Просто найдешь блин значение слова миграция - переселение из точки А в точку Б.

## Работа приложения

Для запуска проекта используется команда `npm run dev`, которая запустить dev версию приложения без компиляции в обычный html, css и js. Также нужно запустить бэкенд сервер командой `node db.js`. После этого в консоли с запущенной командой по запуску приложения будет отображаться ссылка на это приложение. Если перейти по ней, откроется сайт.

Каталог товаров записан в pinia. в формате массива объектов, описанных с помощью TypeScript. Описание товара <Вставить код из файла src/types/TProduct>. Каталог товаров  <Вставить код из файла src/stores/productStore>.

По клику на карточку товара открывается страница просмотра данного товара. На странице доступна кнопка "Купить", которая добавляет товар в корзину.

Описание корзины <Вставить код из файла src/stores/cartStore>.

Описание объекта корзины <Вставить код из файла src/types/TCart>.

Если товар находится в корзине, то вместо кнопки "Купить", будут отображаться кнопки плюс и минус. Также будет отображаться текущее число экземпляров в корзине.

В шапке сайта есть иконка корзины, которая активна только втом случае, если в корзину добавлен хотя бы один товар.

На странице корзины есть возможность посмотреть информацию о добавленных товарах, а также их количество и стоимость. В нижней части страницы отображается итоговая цена и кнопка "Оформить", по клику на которую открывется форма оформления заказа.

На странице оформления заказа находятся поля ввода имени, фамилии, адреса и почты. По клику на кнопку "Продолжить", открывается форма для заполнения данных карты. По клику на кнопку "Готово", очищается корзина и в базу данных записывается информация о пользователе, введенная на странице оформления заказа.

## Как работает запись в Базу данных

Данные введенные на странице оформления заказа сохраняются в переменные.

```typescript

const name = ref('');

const surname = ref('');

const address = ref('');

const email = ref('');

```

После нажатия на кнопку готово происходят следующие действия:
1. Отправляется запрос на создание записи в таблицу users, с данными введенными в форме.
2. Отправляется запрос на создание записи в таблицу orders, с фамилией покупателя и общей стоимостью корзины.
3. Для каждого товара из корзины создается запись в таблице orders_products, где к заказу привязываются все товары из корзины.
4. очищается корзина.
5. Пользовать оказывается на главной странице.
Код сервера <вставить код из файла db.js>.

Код отправки запроса: 

```typescript

const final = async () => {

    //Создаем запись в таблице users
     usersApiStore.storeUser({
        name: name.value,
        surname: surname.value,
        address: address.value,
        email: email.value,
    });
    //создаем запись в таблице orderd
    const order = await ordersApiStore.storeOrder({
        price: allPrice.value,
        surname: surname.value,
    });

    //перебираем товары в корзине
    for (const el of cart.object) {
      //поулчаем товар из таблицы
      const product = await productsApiStore.getProduct(el.id);
      //привязываем полученный товар к заказу
      await orderProductsApiStore.storeOrderProduct({
        productId: product.data.id,
        orderId: order.data.id,
      });
    }
    //очищаем корзину
    clearCart();
    //отправляем пользователя на главную
    router.push({name: 'home'});
};
```
